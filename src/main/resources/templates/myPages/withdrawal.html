<div th:fragment="withdrawalFragment">
    <div class="mypages-modal-content">
        <h3>회원 탈퇴</h3>
        <h4>정말로 회원 탈퇴를 하시겠습니까?</h4>
        <h4 style="color: red">탈퇴 시 모든 정보가 삭제됩니다.</h4>
        <div class="mypages-button-container">
            <button class="mypages-cancelNoButton" onclick="cancelDelete()">아니오</button>
            <button class="mypages-cancelYesButton" onclick="deleteAccount()">예</button>
        </div>
    </div>
    <style>
        /* 모달 창 스타일 */
        .mypages-modal-content {
            background-color: white;
            margin: 10% auto;
            padding: 20px;
            width: 80%;
            max-width: 500px;
            text-align: center;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        /* 버튼 컨테이너 스타일 */
        .mypages-button-container {
            display: flex;
            justify-content: center;
            gap: 10px; /* 버튼 간의 간격을 조절 */
            margin-top: 20px;
        }

        /* 버튼 스타일 */
        .mypages-cancelNoButton,
        .mypages-cancelYesButton {
            padding: 10px 20px;
            background-color: #81c405;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .mypages-cancelNoButton:hover,
        .mypages-cancelYesButton:hover {
            background-color: #555;
        }

        /* 모달창 안의 텍스트 */
        .modal-content p {
            margin: 20px 0;
        }
    </style>
    <script>
        function cancelDelete() {
            // 회원 탈퇴 취소 시 아무런 동작도 하지 않고 모달을 닫는 함수
            closeModal('modal-deleteAccount');
        }

        function deleteAccount() {
            // 회원 탈퇴 요청을 서버로 전송하는 함수
            // AJAX 요청을 통해 현재 로그인한 회원을 삭제
            const xhr = new XMLHttpRequest();
            xhr.open("DELETE", "/member/delete", true); // DELETE 메서드를 사용해 서버에 요청
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    console.log("회원 탈퇴 완료");
                    alert("정삭적으로 탈퇴되었습니다.")
                    window.location.href = "/"; // 탈퇴 후 홈으로 리다이렉트
                } else if (xhr.readyState === 4) {
                    console.error("회원 탈퇴 중 오류 발생", xhr.responseText);
                }
            };
            xhr.send();
        }
    </script>
</div>
