<div th:fragment="withdrawalFragment">
    <div class="mypages-modal-content">
        <span class="mypages-close" onclick="closeModal('modal-deleteAccount')">&times;</span>
        <h2>회원 탈퇴</h2>
        <p>정말로 회원 탈퇴를 하시겠습니까? 탈퇴 시 모든 정보가 삭제됩니다.</p>
        <button class="mypages-cancelNoButton" onclick="cancelDelete()">아니오</button>
        <button class="mypages-cancelYesButton" onclick="deleteAccount()">예</button>
    </div>
    <script>
        function cancelDelete() {
            // 회원 탈퇴 취소 시 아무런 동작도 하지 않고 모달을 닫는 함수
            closeModal('modal-deleteAccount');
        }

        function deleteAccount() {
            // 회원 탈퇴 요청을 서버로 전송하는 함수
            // AJAX 요청을 통해 현재 로그인한 회원을 삭제
            const xhr = new XMLHttpRequest();
            xhr.open("DELETE", "/member/delete", true); // DELETE 메서드를 사용해 서버에 요청
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    console.log("회원 탈퇴 완료");
                    alert("정삭적으로 탈퇴되었습니다.")
                    window.location.href = "/"; // 탈퇴 후 홈으로 리다이렉트
                } else if (xhr.readyState === 4) {
                    console.error("회원 탈퇴 중 오류 발생", xhr.responseText);
                }
            };
            xhr.send();
        }
    </script>
</div>
