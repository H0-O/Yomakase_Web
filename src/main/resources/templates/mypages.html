<div th:fragment="mypages">
    <html lang="en" xmlns:sec="http://www.w3.org/1999/xhtml">
    <section class="resume-section" id="myPages">
        <div class="resume-section-content">
            <div sec:authentication="name">
                <!-- 네비게이션 바 -->
                <div class="mypages-navbarContainer">
                    <div id="mypagesNavbar" class="mypages-navbar">
                        <a href="#" class="mypages-tablink" onclick="openTab(event, 'myrecipe')">나의 레시피</a>
                        <a href="#" class="mypages-tablink" onclick="openTab(event, 'subsService')">구독 서비스</a>
                        <a href="#" class="mypages-tablink" onclick="openTab(event, 'record')">소비 기록</a>
                        <a href="#" class="mypages-tablink" onclick="openTab(event, 'profileUpdate')">회원정보수정</a>
                        <a href="#" class="mypages-tablink" onclick="openTab(event, 'support')">이용문의</a>
                    </div>
                </div>

                <!-- 콘텐츠 영역 -->
                <div id="myrecipe" class="mypages-content">
                    <!-- 여기 나의 레시피 관련 콘텐츠 -->
                </div>

                <div id="subsService" class="mypages-content">
                    <!-- 구독 서비스 섹션 -->
                    <div sec:authorize="hasRole('ROLE_USER')">
                        <div id="mypages-subscribeSection">
                            <h3>구독 서비스</h3>
                            <div class="mypages-subscription-info">
                                <p>구독 시 제공할 서비스</p>
                                <ul>
                                    <li>광고 제거 기능</li>
                                    <li>식단 점수 달력 제공</li>
                                </ul>
                                <p><strong>※ 구독 시 유의사항</strong></p>
                                <p>월 490원으로 제공되는 구독 서비스입니다. 결제는 매월 자동으로 이루어지며, 언제든지 구독을 취소할 수 있습니다.</p>
                                <p>구독 서비스는 「전자상거래 등에서의 소비자 보호에 관한 법률」에 따라 보호받습니다.</p>
                                <div>
                                    <input type="checkbox" id="mypages-agreeTerms" name="mypages-agreeTerms" />
                                    <label for="mypages-agreeTerms">결제에 동의함</label>
                                </div>
                            </div>
                            <button id="mypages-subscribeButton" onclick="subscribe()" disabled>결제</button>
                        </div>
                    </div>
                    <div sec:authorize="hasRole('ROLE_SUBSCRIBER')">
                        <div id="mypages-unsubscribeSection" style="display: none">
                            <h3>구독 서비스</h3>

                            <div class="mypages-subscription-info">
                                <p>구독으로 제공되고 있는 서비스</p>
                                <ul>
                                    <li>광고 제거 기능</li>
                                    <li>식단 점수 달력 제공</li>
                                </ul>
                            </div>
                            <div class="mypages-cancel-info">
                                <p>정말로 구독을 취소하시겠습니까?</p>
                                <button id="mypages-cancelNoButton" onclick="cancelNo()">아니오</button>
                                <button id="mypages-cancelYesButton" onclick="unsubscribe()">예</button>
                            </div>
                        </div>
                    </div>
                </div>


                <div id="record" class="mypages-content">
                    <h3>소비 기록</h3>
                    <p>여기에 소비 기록 내용이 표시됩니다.</p>
                </div>


                <div id="profileUpdate" class="mypages-content">
                    <h3>회원정보수정</h3>
                    <form id="mypages-profileForm">
                        <div class="mypages-form-group">
                            <label for="mypages-username">이름:</label>
                            <input type="text" id="mypages-username" name="username" value="홍길동" />
                        </div>
                        <div class="mypages-form-group">
                            <label for="mypages-email">이메일:</label>
                            <input type="email" id="mypages-email" name="email" value="example@example.com" />
                        </div>
                        <div class="mypages-form-group">
                            <label for="mypages-password">비밀번호:</label>
                            <input type="password" id="mypages-password" name="password" />
                        </div>
                        <div class="mypages-form-group">
                            <label for="mypages-confirmPassword">비밀번호 확인:</label>
                            <input type="password" id="mypages-confirmPassword" name="confirmPassword" />
                        </div>
                        <button type="submit" class="mypages-subscribeButton">정보 수정</button>
                        <button type="button" class="mypages-cancelButton" onclick="openModal('modal-deleteAccount')">회원 탈퇴</button>
                    </form>
                </div>

                <div id="support" class="mypages-content">
                    <h3>1:1 이용문의</h3>
                    <form id="mypages-supportForm">
                        <div class="mypages-form-group">
                            <label for="mypages-supportSubject">제목:</label>
                            <input type="text" id="mypages-supportSubject" name="supportSubject" />
                        </div>
                        <div class="mypages-form-group">
                            <label for="mypages-supportMessage">문의 내용:</label>
                            <textarea id="mypages-supportMessage" name="supportMessage"></textarea>
                        </div>
                        <button type="submit" class="mypages-subscribeButton">문의 보내기</button>
                    </form>
                </div>

                <!-- 모달 창 -->
                <div id="modal1" class="mypages-modal">
                    <div class="mypages-modal-content">
                        <span class="mypages-close" onclick="closeModal('modal1')">&times;</span>
                        <h2>레시피 1</h2>
                        <p>레시피 1의 상세 내용이 여기에 표시됩니다.</p>
                    </div>
                </div>

                <div id="modal2" class="mypages-modal">
                    <div class="mypages-modal-content">
                        <span class="mypages-close" onclick="closeModal('modal2')">&times;</span>
                        <h2>레시피 2</h2>
                        <p>레시피 2의 상세 내용이 여기에 표시됩니다.</p>
                    </div>
                </div>

                <div id="modal3" class="mypages-modal">
                    <div class="mypages-modal-content">
                        <span class="mypages-close" onclick="closeModal('modal3')">&times;</span>
                        <h2>레시피 3</h2>
                        <p>레시피 3의 상세 내용이 여기에 표시됩니다.</p>
                    </div>
                </div>
            </div>

            <!-- 회원 탈퇴 모달 -->
            <div id="modal-deleteAccount" class="mypages-modal">
                <div class="mypages-modal-content">
                    <span class="mypages-close" onclick="closeModal('modal-deleteAccount')">&times;</span>
                    <h2>회원 탈퇴</h2>
                    <p>정말로 회원 탈퇴를 하시겠습니까? 탈퇴 시 모든 정보가 삭제됩니다.</p>
                    <button class="mypages-cancelNoButton" onclick="cancelDelete()">아니오</button>
                    <button class="mypages-cancelYesButton" onclick="deleteAccount()">예</button>
                </div>
            </div>
        </div>
        <!-- 인라인 CSS -->
        <style>
            .mypages-navbarContainer {
                display: flex;
                justify-content: center;
                background-color: white;
                padding: 10px 0;
            }

            .mypages-navbar {
                background-color: #81c405;
                overflow: hidden;
                padding: 0;
                border-radius: 10px;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            }

            .mypages-navbar a {
                display: inline-block;
                color: white;
                text-align: center;
                padding: 14px 20px;
                text-decoration: none;
                font-size: 17px;
            }

            .mypages-navbar a:hover {
                background-color: #6aa003;
            }

            .mypages-content {
                padding: 20px;
                display: none;
                background-color: white;
                margin: 20px auto;
                width: 80%;
                border-radius: 10px;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            }

            #myrecipe {
                display: block; /* 첫 화면에 '나의 레시피'가 보이도록 설정 */
            }

            .mypages-slider {
                position: relative;
                width: 80%;
                margin: 20px auto;
                overflow: hidden;
                border-radius: 10px;
            }

            .mypages-slides {
                display: flex;
                transition: 0.5s ease;
            }

            .mypages-slides img {
                width: 100%;
                border-radius: 10px;
            }

            .mypages-slide {
                min-width: 100%;
                box-sizing: border-box;
            }

            .mypages-slider-nav {
                position: absolute;
                top: 50%;
                width: 100%;
                display: flex;
                justify-content: space-between;
                transform: translateY(-50%);
            }

            .mypages-slider-nav button {
                background-color: rgba(0, 0, 0, 0.5);
                border: none;
                color: white;
                padding: 10px;
                cursor: pointer;
                border-radius: 50%;
            }

            .mypages-modal {
                display: none;
                position: fixed;
                z-index: 1;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                overflow: auto;
                background-color: rgba(0, 0, 0, 0.5);
            }

            .mypages-modal-content {
                background-color: white;
                margin: 15% auto;
                padding: 20px;
                border: 1px solid #888;
                width: 80%;
                border-radius: 10px;
            }

            .mypages-close {
                color: #aaa;
                float: right;
                font-size: 28px;
                font-weight: bold;
            }

            .mypages-close:hover,
            .mypages-close:focus {
                color: black;
                text-decoration: none;
                cursor: pointer;
            }

            .mypages-subscription-info {
                background-color: #f9f5e6;
                padding: 20px;
                border: 1px solid #d3d3d3;
                margin-bottom: 20px;
                border-radius: 5px;
            }

            .mypages-cancel-info {
                text-align: center;
                margin-top: 20px;
                padding: 20px;
                border: 1px solid #d3d3d3;
                background-color: #f9f5e6;
                border-radius: 5px;
            }

            .mypages-subscribeButton,
            .mypages-cancelNoButton,
            .mypages-cancelYesButton {
                padding: 10px 20px;
                margin: 10px;
                border: 1px solid #d3d3d3;
                border-radius: 5px;
                background-color: #e0e0e0;
                cursor: pointer;
            }

            .mypages-subscribeButton:hover,
            .mypages-cancelNoButton:hover,
            .mypages-cancelYesButton:hover {
                background-color: #c0c0c0;
            }

            .mypages-subscribeButton:disabled {
                background-color: #f0f0f0;
                cursor: not-allowed;
            }

            .mypages-subscription-info ul {
                margin-left: 20px;
                list-style-type: disc;
            }
            .mypages-form-group {
                margin-bottom: 20px;
            }

            .mypages-form-group label {
                display: block;
                margin-bottom: 5px;
            }

            .mypages-form-group input,
            .mypages-form-group textarea {
                width: 100%;
                padding: 10px;
                border-radius: 5px;
                border: 1px solid #d3d3d3;
                box-sizing: border-box;
            }

            .mypages-cancelButton {
                background-color: #ff5c5c;
                color: white;
                border: none;
                padding: 10px 20px;
                margin-left: 10px;
                border-radius: 5px;
                cursor: pointer;
            }

            .mypages-cancelButton:hover {
                background-color: #ff1c1c;
            }
        </style>

        <!-- 인라인 JavaScript -->
        <script>
            let currentSlide = 0;

            function moveSlide(n) {
                const slides = document.querySelector(".mypages-slides");
                const totalSlides = slides.children.length;
                currentSlide = (currentSlide + n + totalSlides) % totalSlides;
                slides.style.transform = "translateX(" + -currentSlide * 100 + "%)";
            }

            function openTab(event, tabName) {
                event.preventDefault(); // 페이지 새로 고침 방지
                $(".mypages-content").hide(); // 모든 콘텐츠를 숨김
                $("#" + tabName).show(); // 클릭한 탭의 콘텐츠만 보이도록 설정
            }

            function openModal(modalId) {
                $("#" + modalId).show();
            }

            function closeModal(modalId) {
                $("#" + modalId).hide();
            }

            document
                .getElementById("mypages-agreeTerms")
                .addEventListener("change", function () {
                    document.getElementById("mypages-subscribeButton").disabled =
                        !this.checked;
                });

            function subscribe() {
                if (document.getElementById("mypages-agreeTerms").checked) {
                    alert("구독 결제가 완료되었습니다.");
                    // 구독 결제 로직을 여기에 추가
                    document.getElementById("mypages-subscribeSection").style.display =
                        "none";
                    document.getElementById("mypages-unsubscribeSection").style.display =
                        "block";
                } else {
                    alert("결제에 동의하셔야 구독이 가능합니다.");
                }
            }

            function unsubscribe() {
                const confirmation = confirm("정말로 구독을 취소하시겠습니까?");
                if (confirmation) {
                    alert("구독이 취소되었습니다.");
                    // 구독 취소 로직을 여기에 추가
                    document.getElementById("mypages-subscribeSection").style.display =
                        "block";
                    document.getElementById("mypages-unsubscribeSection").style.display =
                        "none";
                }
            }

            function cancelNo() {
                alert("구독이 유지되었습니다.");
                // 구독 취소 취소 로직을 여기에 추가
            }

            // 페이지 로드 시 첫 번째 탭을 엽니다.
            $(document).ready(function () {
                openTab(event, "myrecipe");
            });
            function cancelDelete() {
                alert("회원 탈퇴가 취소되었습니다.");
            }

            function deleteAccount() {
                const confirmation = confirm("정말로 회원 탈퇴를 하시겠습니까?");
                if (confirmation) {
                    alert("회원 탈퇴가 완료되었습니다.");
                    // 회원 탈퇴 로직을 여기에 추가
                    closeModal('modal-deleteAccount');
                    // 탈퇴 후 처리, 예를 들어 메인 페이지로 이동
                }
            }

            document.getElementById('mypages-profileForm').addEventListener('submit', function(event) {
                event.preventDefault();
                alert('회원정보가 수정되었습니다.');
                // 회원정보 수정 로직 추가
            });

            document.getElementById('mypages-supportForm').addEventListener('submit', function(event) {
                event.preventDefault();
                alert('문의가 제출되었습니다. 빠른 시일 내에 답변 드리겠습니다.');
                // 문의 제출 로직 추가
            });
        </script>
        <!-- jQuery 라이브러리 추가 -->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    </section>

    </html>
</div>