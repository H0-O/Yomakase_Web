<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>회원가입</title>
  <style>
    @keyframes smoothAppear {
      from {
        opacity: 0;
        transform: translate3d(0, -100%, 0);
      }
      to {
        opacity: 1;
        transform: translateZ(0);
      }
    }

    /* 모달 창 스타일 */
    .modal-content {
      background-color: white;
      margin: 5% auto;
      padding: 20px;
      width: 80%;
      height: 100%;
      max-width: 500px;
      max-height: 650px;
      text-align: center;
      border-radius: 10px;
      position: relative;
    }

    /* 모달 배경 */
    body {
      display: none; /* 처음엔 보이지 않도록 설정 */
      position: fixed;
      z-index: 1000; /* z-index를 충분히 높게 설정 */
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0, 0, 0, 0.5); /* 반투명 검정 배경 */
    }

    /* 버튼 스타일 */
    .button-container {
      display: flex;
      flex-direction: row; /* 가로로 배치 */
      justify-content: center; /* 가운데 정렬 */
      gap: 10px; /* 버튼 간의 간격 */
    }

    .btn {
      padding: 10px 20px;
      margin: 10px;
      background-color: #81c405;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .btn:hover {
      background-color: #555;
    }

    /* 폼 스타일 */
    .form-group {
      margin-bottom: 15px;
      text-align: left;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #333;
    }

    .form-group input {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 1rem;
      box-sizing: border-box;
    }

    /* 알레르기 영역을 감싸는 부모 요소 */
    .allergy-group {
      max-height: 250px; /* 필요에 따라 높이를 조정하세요 */
      overflow-y: auto;
      margin-bottom: 15px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }

    /* 드롭다운 스타일 수정 */
    .dropdown {
      position: relative;
      text-align: left;
      margin-bottom: 10px;
    }

    .dropdown-label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      padding: 10px;
      background-color: #f1f1f1;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-weight: bold;
      color: #333;
      transition: background-color 0.3s;
    }

    .dropdown-label:hover {
      background-color: #ddd;
    }

    .dropdown-content {
      display: none;
      position: relative; /* 수정된 부분: 드롭다운 메뉴가 부모 요소 안에서 위치하도록 */
      width: 100%;
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 5px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      z-index: 1;
    //max-height: 200px;
    //overflow-y: auto;
      margin-top: 5px; /* 드롭다운 메뉴와 레이블 사이에 간격 추가 */
      overflow: hidden; /* 내부 스크롤 제거 */
    }

    .dropdown-content.show {
      display: block;
    }

    .dropdown-content label {
      display: block;
      padding: 10px;
      border-bottom: 1px solid #ddd;
      cursor: pointer;
    }

    .dropdown-content label:last-child {
      border-bottom: none;
    }

    .dropdown-content label.selected {
      background-color: #81c405;
      color: white;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      position: relative;
    }

    .custom-heading {
      font-size: 1.5em;
      font-weight: bold;
      margin: 0.67em 0;
      color: inherit;
      flex: 1;
      text-align: center;
    }

    .header .back-btn {
      font-size: 1.8rem;
      color: #81c405;
      border: none;
      cursor: pointer;
      background: none;
      visibility: visible; /* 기본값 */
    }

    .close {
      color: #aaa;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }
    /* 닫기 버튼 */

    .close:hover,
    .close:focus {
      color: black;
      text-decoration: none;
      cursor: pointer;
    }

    /* 성별 토글 버튼 스타일 */
    .gender-group {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .gender-toggle {
      display: flex;
      border: 1px solid #ddd;
      border-radius: 15px;
      overflow: hidden;
      cursor: pointer;
      background-color: #f1f1f1;
      position: relative;
    }

    .gender-toggle button {
      flex: 1;
      border: none;
      padding: 10px;
      background-color: #fff;
      color: #333;
      font-weight: bold;
      cursor: pointer;
      transition: background-color 0.3s, color 0.3s;
    }

    .gender-toggle button.selected {
      background-color: #81c405;
      color: white;
    }

    .gender-toggle button:nth-of-type(1) {
      border-right: 1px solid #ddd;
    }

    .gender-toggle button:hover {
      background-color: #ddd;
    }
  </style>
</head>
<body>

<div class="modal-content">
  <form action="signupForm" method="post">

    <!-- 이메일 (ID) -->
    <div class="form-group">
      <label for="email">이메일(ID)</label>
      <input type="email" id="email" name="email" readonly required>
      <input type="button" value="이메일 중복확인" id="checkId"> <!-- ID 중복 확인 버튼 -->
    </div>

    <!-- 닉네임 -->
    <div class="form-group">
      <label for="nickname">닉네임</label>
      <input type="text" id="nickname" name="nickname" required autocomplete="username">
    </div>

    <!-- 비밀번호 -->
    <div class="form-group">
      <label for="password">비밀번호</label>
      <input type="password" id="password" name="password" required autocomplete="current-password">
    </div>

    <!-- 비밀번호 확인 -->
    <div class="form-group">
      <label for="confirm_password">비밀번호 확인</label>
      <input type="password" id="confirm_password" name="confirm_password" required autocomplete="new-password">
    </div>

    <!-- 생년월일 -->
    <div class="form-group">
      <label for="birthdate">생년월일</label>
      <input type="date" id="birthdate" name="birthdate" required>
    </div>

    <!-- 성별 -->
    <div class="form-group">
      <label for="gender">성별</label>
      <select id="gender" name="gender" required>
        <option value="M">남성</option>
        <option value="F">여성</option>
      </select>
    </div>

    <!-- 키 (선택) -->
    <div class="form-group">
      <label for="height">키 (선택)</label>
      <input type="text" id="height" name="height">
    </div>

    <!-- 몸무게 (선택) -->
    <div class="form-group">
      <label for="weight">몸무게 (선택)</label>
      <input type="text" id="weight" name="weight">
    </div>

    <!-- 알레르기 정보 (선택, 체크박스 형태) -->
    <div class="allergy-group">
      <div class="dropdown">
        <div class="dropdown-label" id="meat-dropdown">
          고기류
          <span id="meat-chevron">&#9662;</span>
        </div>
        <div class="dropdown-content" id="meat-content">
          <label><input type="hidden" name="allergy" value="알"> 알 (가금류만 해당한다)</label>
          <label><input type="hidden" name="allergy" value="돼지고기"> 돼지고기</label>
          <label><input type="hidden" name="allergy" value="닭고기"> 닭고기</label>
          <label><input type="hidden" name="allergy" value="쇠고기"> 쇠고기</label>
        </div>
      </div>
      <div class="dropdown">
        <div class="dropdown-label" id="seafood-dropdown">
          해산물
          <span id="seafood-chevron">&#9662;</span>
        </div>
        <div class="dropdown-content" id="seafood-content">
          <label><input type="hidden" name="allergy" value="고등어"> 고등어</label>
          <label><input type="hidden" name="allergy" value="게"> 게</label>
          <label><input type="hidden" name="allergy" value="새우"> 새우</label>
          <label><input type="hidden" name="allergy" value="오징어"> 오징어</label>
          <label><input type="hidden" name="allergy" value="조개류"> 조개류 (굴, 전복, 홍합을 포함한다)</label>
        </div>
      </div>
      <div class="dropdown">
        <div class="dropdown-label" id="fruit-dropdown">
          과일류
          <span id="fruit-chevron">&#9662;</span>
        </div>
        <div class="dropdown-content" id="fruit-content">
          <label><input type="hidden" name="allergy" value="복숭아"> 복숭아</label>
          <label><input type="hidden" name="allergy" value="토마토"> 토마토</label>
        </div>
      </div>
      <div class="dropdown">
        <div class="dropdown-label" id="nut-dropdown">
          견과류
          <span id="nut-chevron">&#9662;</span>
        </div>
        <div class="dropdown-content" id="nut-content">
          <label><input type="hidden" name="allergy" value="땅콩"> 땅콩</label>
          <label><input type="hidden" name="allergy" value="대두"> 대두</label>
          <label><input type="hidden" name="allergy" value="호두"> 호두</label>
          <label><input type="hidden" name="allergy" value="잣"> 잣</label>
        </div>
      </div>
      <div class="dropdown">
        <div class="dropdown-label" id="grain-dropdown">
          곡물
          <span id="grain-chevron">&#9662;</span>
        </div>
        <div class="dropdown-content" id="grain-content">
          <label><input type="hidden" name="allergy" value="메밀"> 메밀</label>
          <label><input type="hidden" name="allergy" value="밀"> 밀</label>
        </div>
      </div>
      <div class="dropdown">
        <div class="dropdown-label" id="dairy-dropdown">
          유제품
          <span id="dairy-chevron">&#9662;</span>
        </div>
        <div class="dropdown-content" id="dairy-content">
          <label><input type="hidden" name="allergy" value="우유"> 우유</label>
        </div>
      </div>
    </div>

    <!-- 제출 버튼 -->
    <div>
      <button type="submit" class="btn">회원가입</button>
    </div>
  </form>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function () {
    // 가입 누를때
    $('.modal-content').submit(save);

    // ID중복확인 누를때
    $('#checkId').click(idCheck); // ① 타입이 button일 경우
  });

  // 가입 누를때
  function save() {
    let id = $('#id').val();
    let pw = $('#pw').val();
    let repw = $('#confirm_password').val();
    let name = $('#nickname').val();
    let birthdate = $('#birthdate').val();

    if(id.length > 8 || id.length < 3) {
      alert("아이디는 이메일 형식으로 만들어주세요")
      return false;
    }
    if(pw.length <= 2) {
      alert("비밀번호는 3자 이상으로 만들어주세요")
      return false;
    }
    if(pw != repw) {
      alert("일치하지 않는 비밀번호입니다")
      return false;
    }
    if(name === '') {
      alert("닉네임을 입력하세요")
      return false;
    }
    if (birthdate === '') {
      alert('생년월일을 선택해주세요')
      return false;
    }
    alert("회원가입이 완료되었습니다.");
    return true;
  }

  // ID중복확인 클릭시
  function idCheck() {
    window.open('/idCheck', 'idWin', 'left=500,top=200,width=400,height=300,location=no,titlebar=no');
  }
</script>

</body>
</html>
